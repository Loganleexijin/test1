# 项目优化建议报告

**生成日期**: 2026-01-14
**状态**: 待处理

本报告汇总了对项目代码库进行安全审查和性能分析后的发现及优化建议。

## 1. 安全性问题 (高优先级)

### 🔴 硬编码的 API 密钥
- **位置**: `api/routes/ai.ts`
- **问题**: AI 服务的 API Key 直接硬编码在源码中。
  ```typescript
  // 当前代码
  const API_KEY = 'aa75539a-ddc6-4442-97b5-8d2d8d4be7c4';
  ```
- **风险**: 如果代码库公开（如推送到 GitHub），密钥将泄露，可能导致配额被盗用或产生意外费用。
- **建议**: 
  1. 将密钥移至 `.env` 环境变量文件（如 `VITE_AI_API_KEY`）。
  2. 在代码中通过 `import.meta.env.VITE_AI_API_KEY` 或 `process.env` 读取。
  3. 立即轮换/重置该 API Key。

### 🟡 缺少环境配置模版
- **问题**: 项目根目录缺少 `.env.example` 文件。
- **建议**: 创建 `.env.example`，列出项目所需的所有环境变量名称（不包含具体值），方便新开发者快速配置环境。

## 2. 代码质量与规范

### 🟡 散落的调试日志
- **问题**: 代码中存在多个 `console.log` 语句（如 `api/routes/ai.ts` 中的错误打印）。
- **建议**: 
  1. 生产环境构建时应去除 `console.log`。
  2. 建议引入统一的日志工具或仅在开发模式下打印日志。

### 🟡 本地存储直接访问
- **位置**: `src/hooks/useTheme.ts`
- **问题**: 直接使用了 `localStorage.getItem` 和 `setItem`。
- **建议**: 虽然 Zustand 已经处理了大部分持久化，但对于独立的主题设置，建议也封装统一的 Storage Helper，避免键名冲突和类型错误。

## 3. 已完成的优化

- ✅ **移除冗余代码**: 已彻底删除未使用的 `HealthProfile` 相关组件、类型定义及 Store 状态，减少了包体积并消除了潜在的维护负担。
- ✅ **通知系统精简**: 已移除 4 个非核心通知类型，仅保留断食提醒和每日打卡，提升了用户体验。

## 4. 下一步架构规划 (进行中)

- **Supabase 集成**: 目前用户数据存储在本地 (LocalStorage)，计划迁移至 Supabase 云数据库，以支持多设备同步和数据备份。
- **数据表设计**: 正在规划 `users` (基础信息) 和 `user_stats` (身体数据) 表结构。
